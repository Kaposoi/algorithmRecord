# 存储程序计算机

## 最大游程

对于一个十进制数串， 最大游程是指其中值相同的数字连续出现的最大次数



## 存储器

存储器的每一个位置要么保存指令， 要么保存数据



### 存储系统的组成

![](F:\E盘\编程学习\计算机组成原理\机械工业出版社\计算机体系结构\存储器.png)

三条总线连接内存和cpu

控制总线 -> 发送指令信号(读或者写)

数据总线 -> 双向， 写数据或读数据

地址总线 -> 用于cpu寻址(找到指定的存储单元)

>存储的本质都是01串， 不知道哪些是数据哪些是指令



处理器将一个放在地址总线上的地址以及一个用于选择读或写操作(也称为读写周期)的控制信号发送给存储器

读周期中 ， 存储器将数据放在数据总线上供CPU读取

写周期中， 放在数据总线上的数据被写入存储器

信息进入或离开存储器的地方叫端口



## 寄存器传输语言(RTL)

RTL可以更容易的定义计算机内发生的操作



区分存储单元的地址和它的内容非常重要

在RTL语言中， 用[]表示存储单元的内容， 如

[15] = MAX_RUN

地址为15的存储单元保存了变量MAX_RUN的值， 左箭头表示数据传送操作，如
$$
[15]<--[15]+1
$$
将地址为15的存储单元的值+1， 然后写回地址为15的存储单元





## 存储程序的概念

程序计数器指向存储器的第一条指令 

循环执行:

​	从程序计数器所指的存储单元读出指令

​	让程序计数器指向下一条指令

​	将从存储器中取出的指令解码

​	执行解码

结束



执行一条指令需要至少*两次*访存， 第一次是*读取指令*， 第二次要么从存储器读取数据， 要么把它之前读取的指令产生或修改的数据写回存储器



## 指令格式

>Operation Address1, Address2, ...

这条指令中， 操作数是数据的*地址*， 而不是数据本身

>ADD P, Q, R 是一条典型的三操作数指令， P Q R是三个存储单元的地址的符号名
>
>可以用RTL表示为:
>$$
>[Address1]<-[Address2]Operation[Address3]
>$$
>



### 两地址指令

两地址指令会破坏它的一个操作数， 也就是说， 会用*结果*替换*源操作数*
$$
Operation \quad destination, \quad source
$$


实际计算机中一般不允许同一条指令中使用两个存储地址， 大多数计算机规定一个是*存储器地址*， 另外一个是*寄存器*



### 单地址指令

有些计算机实现了单地址指令
$$
Operation \quad address
$$
指令中只提供了一个操作数地址， 而指令至少需要两个操作数地址， 处理器不得不使用一个不需要地址的第二操作数， 第二操作数来自于*累加器*(累加器是一个寄存器)

>实现P = Q + R
>
>将Q读入到累加器 -> 将R加上Q -> 结果返回到Z中存储



## 计算机分类

按照计算机*指令处理数据方式*分类

*存储器-存储器*型， 一条指令能够从存储器中读出源操作数， 对数据完成某个操作， 并将结果保存在存储器中



*寄存器-存储器*型， 能够处理两个数据， 其中一个位于存储器中， 另一个位于寄存器中， 结果要么被写回寄存器， 要么被写回存储器



*寄存器-寄存器*型, 只能对寄存器中的内容进行操作， 这些计算机必须通过*LOAD*指令将数据读入到寄存器中并且使用*STORE*指令将数据从寄存器中送回存储器， 这些计算机被称为*load/store*型计算机， 因为LOAD和STORE操作是仅有的存储器访问指令



## 存储层次

由于CPU和存储器的性能之间的差距不断加大， 通过在使用数据之前将它们从存储器中取出消除*相对*慢速的存储器的影响， 降低延迟



### 一般分划

寄存器: 存放处理器的工作数据(1 ns, 8 16 32 64位)

Cache: 缓存常用数据的快速存储器(8Mbyte 10ns)

DRAM: 存放工作数据(8Gbyte 40ns)

硬盘: 保存程序和数据(1Tbyte 20ms)

>*硬盘的容量是寄存器的4000万倍， 速度却只有寄存器的2000万分之一*



#### Cache高速缓存

经常被用到的数据保存在Cache中， Cache访问时间比主存短得多， Cache保存的是主存中经常使用的数据的副本， Cache系统与计算机的*地址总线*和*数据总线*相连， 监听CPU和存储器间的事务



只要Cache注意到CPU发出的地址和它保存的某个数据元素的地址相同， 就把这个数据发送给cpu， 而不会去主存中取数据



*一级缓存*: CPU中集成了一级缓存Cache

*二级缓存*:  容量大于一级缓存， 访问速度慢于一级缓存

*三级缓存*: 容量大于二级缓存， 访问慢于二级缓存



