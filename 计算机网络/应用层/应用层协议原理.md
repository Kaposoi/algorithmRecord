# 应用层协议原理

两种主流程序模型



### **C/S体系结构**

服务器具有**固定， 周知**的地址， 即ip地址

>包括web， FTP， telnet， 电邮等

当web服务器接收到来自某客户对某对象的请求时， 它向该客户发送请求的对象作为响应

配备大量主机的**数据中心**常用于被创建强大的虚拟服务器， 主要是用于解决单主机负担过重的问题	



### **P2P对等结构**

p2p体系结构中对于位于数据中心的专用服务器的依赖很小

应用程序在间断链接的主机之间使用直接通信， 这些主机被称为**对等方**

这种对等方间的通信不必通过专门的服务器， 该体系结构被称为**对等方到对等方的**



许多流量的， 流量密集型应用都是p2p体系结构， 比如说应用包括文件共享， 对等方协助下载器（迅雷）， 因特网电话和视频会议

某些应用具有混合体系结构， 结合了C/S和p2p体系



P2P体系结构最引人入胜的特性便是它的**自扩展性**， 比如说在文件共享应用中， 每个对等方都由于请求文件产生了工作负载， 但是每个对等方向其他对等方分发文件也为系统增加了服务能力。



## 进程通信

进行通信的实际上是**进程**而不是**程序**， 一个进程可以被认为是运行在端系统的一个程序

当多个进程运行在同一个端系统上时， 它们使用进程间通信机制相互通信

规则由操作系统确定



在两个不同端系统上的进程， 通过跨越计算机网络交换**报文**而进行通信

发送进程生成并向网络中发送报文， 接收进程接收这些报文并可能通过回送报文进行响应。



网络应用程序由成对的进程组成



对于每对通信进程之间， 一个是**客户**， 另一个则是**服务器**

P2P体系结构中， 上传文件的是**服务器**， 下载的是**客户**



在一对进程之间的通信会话场景中， 发起通信(在该会话开始时发起与其他进程的联系)的是**客户**， 等待联系的进程是**服务器**



### 进程与计算机网络之间的接口

进程通过**套接字(socket)**软件接口向网络发送报文和接收报文

>如果说进程是房子， 那么套接字则是房子的门， 可以通过门把东西运进来和运出去

套接字是同一台主机应用层和运输层的接口， 是建立网络应用程序的可编程接口。

于是套接字也被称为应用程序和网络之间的**应用程序编程接口(API)**

开发者可以控制套接字在应用层的一切， 但是几乎无权管辖运输层。

对于运输层， 可以选择运输层协议， 和设定几个参数， 比如说最大缓存和报文段长度等



### 进程寻址

**ip地址**用于标识主机， 而**端口**用于标识**进程(套接字)**



## 可供应用程序使用的运输服务

可以从四个方面对应用程序服务要求进行分类: 

**可靠数据传输， 吞吐量， 定时和安全性**



### 可靠数据传输

如果应用程序的一端发送的数据正确完全地交付给了另一端， 如果一个协议提供了这样确保数据交付服务， 就认为提供了可靠数据传输	

有些应用可以容忍数据丢失， 比如说多媒体应用。



### 吞吐量

运输层协议能够以某种特定的速率提供确保的可用吞吐量

>可用吞吐量: 发送进程能够向接收进程交付比特的速率



具有吞吐量要求的应用程序称为**带宽敏感的应用**

**弹性应用**能够根据当时可用的带宽或多或少的利用可供利用的吞吐量



### 定时

定时服务一般是用于电话， 交互式实时应用程序等



## 因特网提供的运输服务

### TCP

tcp服务提供了面向链接和可靠传输服务



**面向连接**

>在应用层报文开始流动之前， TCP让客户和服务器之间相互交换控制信息， 在握手阶段之后， 一个TCP连接就在两个进程套接字之间建立了， 连接双方的进程可以在此同时进行报文收发， 当应用程序结束报文发送时， 必须拆除该连接



**可靠的数据连接服务**

>通信进程可以依靠TCP， 无差错， 按适当顺序交付所有发送的顺序



TCP还拥有拥塞控制机制， 它可以为因特网整体带来好处



**安全套接字层(SSL)， 是TCP协议的加强版**





### UDP

udp仅提供最小服务， 无连接。

它不关心报文是否可以到达接收进程， 就算到达， 报文也可能是乱序的

没有拥塞控制机制。



### 运输协议不提供的服务

无法保证定时和带宽



## 应用层协议

定义了运行在不同端系统上的应用程序如何相互传递报文

>交换的报文类型， 例如请求和响应
>
>各种报文类型的语法
>
>字段的语义
>
>确定一个进程何时以及如何发送报文， 对报文进行响应的规则