# [Miller-Rabin 质数测试](https://hihocoder.com/problemset/problem/1287)

**费马小定理：**

>对于质数p和任意整数a，有a^p % mod == a % mod,即a^(p-1) % mod == 1 % mod

也即是说：假设我们要测试 n 是否为质数。我们可以随机选取一个数 a ，然后计算 a^(n-1)%mod ，如果结果不为 1 ，我们可以 100% 断定 n 不是质数。否则我们再随机选取一个新的数 a 进行测试。如此反复多次，如果每次结果都是 1 ，我们就假定 n 是质数。

**二次探测定理：**

>如果p是素数且p是奇数，则x^2 % p == 1 % p 的解为x == 1 % p或者x == p - 1 % p  

如果a ^ ( n - 1 ) == 1 % n ， 若n - 1是偶数，则测试a ^ ( n - 1 >> 1 ) 是否满足二次探测定理，即结果为1或者是n - 1；

若结果还是1且n - 1 >> 1是偶数可以继续判断，如果结果是n - 1就不能判断了。